\doxysection{Orderbook.\+cpp}
\hypertarget{_orderbook_8cpp_source}{}\label{_orderbook_8cpp_source}\index{OrderbookSim/Orderbook.cpp@{OrderbookSim/Orderbook.cpp}}
\mbox{\hyperlink{_orderbook_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_orderbook_8hpp}{Orderbook.hpp}}"{}}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ <mutex>}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ \textcolor{keywordtype}{bool}\ Orderbook::canMatch(\mbox{\hyperlink{_side_8hpp_a8c0137d7160ad71b6ed265c53c99ed00}{Side}}\ side,\ \mbox{\hyperlink{_usings_8hpp_a375e30b119b87df2956b839a36a8d2d5}{Price}}\ price)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00006\ \ \ \ \ \textcolor{keywordflow}{if}\ (side\ ==\ \mbox{\hyperlink{_side_8hpp_a8c0137d7160ad71b6ed265c53c99ed00a831a28f1e8df07c553fcd59546465d13}{Side::Buy}})\ \{}
\DoxyCodeLine{00007\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_asks.empty())\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00008\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ [bestAsk,\ \_]\ =\ *\_asks.begin();\ \textcolor{comment}{//\ gets\ the\ price}}
\DoxyCodeLine{00009\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ price\ >=\ bestAsk;}
\DoxyCodeLine{00010\ \ \ \ \ \}\ \textcolor{comment}{//\ else\ not\ needed}}
\DoxyCodeLine{00011\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_bids.empty())\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00012\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ [bestBid,\ \_]\ =\ *\_bids.begin();\ \textcolor{comment}{//\ gets\ the\ price}}
\DoxyCodeLine{00013\ \ \ \ \ \textcolor{keywordflow}{return}\ price\ <=\ bestBid;}
\DoxyCodeLine{00014\ \}}
\DoxyCodeLine{00015\ \mbox{\hyperlink{_trade_8hpp_a2ac952e5c0e734c3b7ab2068eb3d6527}{Trades}}\ Orderbook::MatchOrders()}
\DoxyCodeLine{00016\ \{}
\DoxyCodeLine{00017\ \ \ \ \ \mbox{\hyperlink{_trade_8hpp_a2ac952e5c0e734c3b7ab2068eb3d6527}{Trades}}\ trades;}
\DoxyCodeLine{00018\ \ \ \ \ trades.reserve(\_orders.size());}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \ \ \ \ \textcolor{keywordflow}{while}\ (\textcolor{keyword}{true})}
\DoxyCodeLine{00021\ \ \ \ \ \{}
\DoxyCodeLine{00022\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_bids.empty()\ ||\ \_asks.empty())}
\DoxyCodeLine{00023\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\&\ [bidPrice,\ bids]\ =\ *\_bids.begin();}
\DoxyCodeLine{00026\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\&\ [askPrice,\ asks]\ =\ *\_asks.begin();}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00028\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (bidPrice\ >\ askPrice)\ \textcolor{comment}{//\ for\ some\ reasoon\ this\ works:\ bidPrice\ >\ askPrice\ should\ be\ the\ other\ way\ around}}
\DoxyCodeLine{00029\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (!bids.empty()\ \&\&\ !asks.empty())}
\DoxyCodeLine{00032\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00033\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_order_8hpp_abd4d2b4dd984ef7a42731f33c665be3e}{OrderPtr}}\ bid\ =\ bids.front();}
\DoxyCodeLine{00034\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_order_8hpp_abd4d2b4dd984ef7a42731f33c665be3e}{OrderPtr}}\ ask\ =\ asks.front();}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00036\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_usings_8hpp_a90c79bb14ac40b274a4d20dd85f0469d}{Quantity}}\ quantity\ =\ std::min(bid-\/>getRemainingQty(),\ ask-\/>getRemainingQty());}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ \ \ \ \ bid-\/>Fill(quantity);}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ \ \ \ \ ask-\/>Fill(quantity);}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (bid-\/>isFilled())}
\DoxyCodeLine{00042\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00043\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bids.pop\_front();}
\DoxyCodeLine{00044\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_orders.erase(bid-\/>getOrderId());}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ask-\/>isFilled())}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ asks.pop\_front();}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_orders.erase(ask-\/>getOrderId());}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \ \ \ \ trades.push\_back(\mbox{\hyperlink{class_trade}{Trade}}\{}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_trade_info}{TradeInfo}}\{\ bid-\/>getOrderId(),\ bid-\/>getPrice(),\ quantity\ \},}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_trade_info}{TradeInfo}}\{\ ask-\/>getOrderId(),\ ask-\/>getPrice(),\ quantity\ \}}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_usings_8hpp_a375e30b119b87df2956b839a36a8d2d5}{Price}}\ purchasedPrice\ =\ 0;}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (\_executionType)\ \{}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ExecutionTypes::BuyersPrice:}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ purchasedPrice\ =\ std::max(ask-\/>getPrice(),\ bid-\/>getPrice());}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ExecutionTypes::SellersPrice:}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ purchasedPrice\ =\ std::min(ask-\/>getPrice(),\ bid-\/>getPrice());}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ExecutionTypes::MidPrice:}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ purchasedPrice\ =\ (ask-\/>getPrice()\ +\ bid-\/>getPrice())\ /\ 2;}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{default}:\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \ \ \ \ \_orderDetailHistory.\mbox{\hyperlink{class_order_detail_history_a022cf43ca89b41961555b35b38f55111}{removeMatchedOrder}}(bid-\/>getOrderId(),\ ask-\/>getOrderId());}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \ \ \ \ onOrderMatched(bid-\/>getPrice(),\ quantity,\ bid-\/>isFilled());}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \ \ \ \ onOrderMatchedWithHistoryUpdate(ask-\/>getPrice(),\ quantity,\ ask-\/>isFilled(),\ purchasedPrice);\ \textcolor{comment}{//\ we\ are\ purchasing\ at\ the\ max\ price}}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (bids.empty())}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ \ \ \ \ \_bids.erase(bidPrice);}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \ \ \ \ \_data.erase(bidPrice);}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00085\ }
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (asks.empty())}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \ \ \ \ \_asks.erase(askPrice);}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \ \ \ \ \_data.erase(askPrice);}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00091\ \ \ \ \ \}}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_bids.empty())}
\DoxyCodeLine{00094\ \ \ \ \ \{}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\&\ [\_,\ bids]\ =\ *\_bids.begin();}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\&\ order\ =\ bids.front();}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (order-\/>getOrderType()\ ==\ \mbox{\hyperlink{_order_type_8hpp_a57124e387290311f33f3b54a54930418aecbd0e0c1a29b254d42a648d45b65fb9}{OrderType::FillAndKill}})}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_orderbook_a3931170d2aebc21100ca99ee83823d96}{CancelOrder}}(order-\/>getOrderId());}
\DoxyCodeLine{00099\ \ \ \ \ \}}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00101\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_asks.empty())}
\DoxyCodeLine{00102\ \ \ \ \ \{}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\&\ [\_,\ asks]\ =\ *\_asks.begin();}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\&\ order\ =\ asks.front();}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (order-\/>getOrderType()\ ==\ \mbox{\hyperlink{_order_type_8hpp_a57124e387290311f33f3b54a54930418aecbd0e0c1a29b254d42a648d45b65fb9}{OrderType::FillAndKill}})}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_orderbook_a3931170d2aebc21100ca99ee83823d96}{CancelOrder}}(order-\/>getOrderId());}
\DoxyCodeLine{00107\ \ \ \ \ \}}
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00109\ \ \ \ \ \textcolor{keywordflow}{return}\ trades;}
\DoxyCodeLine{00110\ \}}
\DoxyCodeLine{00111\ \textcolor{keywordtype}{void}\ Orderbook::CancelOrders(\mbox{\hyperlink{_usings_8hpp_a486ef20e0a73d508bd0cce5f8217810b}{OrderIds}}\ orderIds)\ \{}
\DoxyCodeLine{00112\ \ \ \ \ std::scoped\_lock\ ordersLock\{\ \_ordersMutex\ \};}
\DoxyCodeLine{00113\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ orderId\ :\ orderIds)\ CancelOrderInternal(orderId);}
\DoxyCodeLine{00114\ \}}
\DoxyCodeLine{00115\ \textcolor{keywordtype}{void}\ Orderbook::CancelOrderInternal(\mbox{\hyperlink{_usings_8hpp_a90716e500cb73455f03ac5b21fc7c219}{OrderId}}\ orderId)\ \{\ \textcolor{comment}{//\ You\ would\ have\ to\ take\ the\ mutex\ a\ lot\ of\ times\ wasting\ time\ (only\ taking\ the\ mutex\ one)}}
\DoxyCodeLine{00116\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_orders.contains(orderId))\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00117\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ [order,\ orderIter]\ =\ \_orders.at(orderId);\ \textcolor{comment}{//\ types\ returned\ OrderId,\ OrderEntry}}
\DoxyCodeLine{00118\ }
\DoxyCodeLine{00119\ \ \ \ \ \textcolor{keywordflow}{if}\ (order-\/>getSide()\ ==\ \mbox{\hyperlink{_side_8hpp_a8c0137d7160ad71b6ed265c53c99ed00a3068c5a98c003498f1fec0c489212e8b}{Side::Sell}})\ \{}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ price\ =\ order-\/>getPrice();}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\&\ orders\ =\ \_asks.at(price);}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ orders.erase(orderIter);}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (orders.empty())\ \_asks.erase(price);}
\DoxyCodeLine{00124\ \ \ \ \ \}}
\DoxyCodeLine{00125\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{comment}{//if(order-\/>getSide()\ ==\ Side::Buy)\ }}
\DoxyCodeLine{00126\ \ \ \ \ \{}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ price\ =\ order-\/>getPrice();}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\&\ orders\ =\ \_bids.at(price);}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ orders.erase(orderIter);}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (orders.empty())\ \_bids.erase(price);}
\DoxyCodeLine{00131\ \ \ \ \ \}}
\DoxyCodeLine{00132\ \ \ \ \ onOrderCanceleld(order);}
\DoxyCodeLine{00133\ \ \ \ \ \_orders.erase(orderId);\ \textcolor{comment}{//\ delete\ the\ order\ from\ orders\ by\ Id\ at\ the\ end}}
\DoxyCodeLine{00134\ }
\DoxyCodeLine{00135\ }
\DoxyCodeLine{00136\ \}}
\DoxyCodeLine{00137\ \textcolor{keywordtype}{bool}\ Orderbook::canFullyFill(\mbox{\hyperlink{_side_8hpp_a8c0137d7160ad71b6ed265c53c99ed00}{Side}}\ side,\ \mbox{\hyperlink{_usings_8hpp_a375e30b119b87df2956b839a36a8d2d5}{Price}}\ price,\ \mbox{\hyperlink{_usings_8hpp_a90c79bb14ac40b274a4d20dd85f0469d}{Quantity}}\ quantity)\textcolor{keyword}{\ const\ }\{\ \textcolor{comment}{//\ if\ the\ order\ is\ fully\ filled\ we\ need\ to\ remove\ the\ order\ count\ from\ our\ bookkeeping\ DS,\ if\ not\ fully\ filled\ is\ does\ not\ need\ to\ be\ touched}}
\DoxyCodeLine{00138\ \ \ \ \ \textcolor{keywordflow}{if}\ (!canMatch(side,\ price))\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};\ \textcolor{comment}{//\ does\ this\ order\ cause\ a\ cross}}
\DoxyCodeLine{00139\ }
\DoxyCodeLine{00140\ \ \ \ \ std::optional<Price>threshold;}
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00142\ \ \ \ \ \textcolor{keywordflow}{if}\ (side\ ==\ \mbox{\hyperlink{_side_8hpp_a8c0137d7160ad71b6ed265c53c99ed00a831a28f1e8df07c553fcd59546465d13}{Side::Buy}})\ \{\ \textcolor{comment}{//\ if\ it\ can\ match\ and\ its\ a\ buy\ we\ know\ theres\ at\ least\ one\ sell}}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ [askPrice,\ \_]\ =\ *\_asks.begin();}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ threshold\ =\ askPrice;}
\DoxyCodeLine{00145\ }
\DoxyCodeLine{00146\ \ \ \ \ \}}
\DoxyCodeLine{00147\ \ \ \ \ \textcolor{keywordflow}{else}\ \{\textcolor{comment}{//\ if\ it\ can\ match\ and\ its\ a\ sell\ we\ know\ that\ bids\ exists}}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ [bidPrice,\ \_]\ =\ *\_bids.begin();}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ threshold\ =\ bidPrice;}
\DoxyCodeLine{00150\ \ \ \ \ \}}
\DoxyCodeLine{00151\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ [levelPrice,\ levelData]\ :\ \_data)\ \{\ \textcolor{comment}{//\ we\ care\ about\ the\ quantity\ in\ the\ range\ of\ the\ best\ ask\ and\ the\ ask\ the\ person\ wants:\ filter\ for\ at\ or\ below\ that\ levelPrice}}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (threshold.has\_value()\ \&\&}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \ \ \ \ (side\ ==\ \mbox{\hyperlink{_side_8hpp_a8c0137d7160ad71b6ed265c53c99ed00a831a28f1e8df07c553fcd59546465d13}{Side::Buy}}\ \&\&\ threshold.value()\ >\ levelPrice)\ ||}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \ \ \ \ (side\ ==\ \mbox{\hyperlink{_side_8hpp_a8c0137d7160ad71b6ed265c53c99ed00a3068c5a98c003498f1fec0c489212e8b}{Side::Sell}}\ \&\&\ threshold.value()\ <\ levelPrice)}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \ \ \ \ )\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((side\ ==\ \mbox{\hyperlink{_side_8hpp_a8c0137d7160ad71b6ed265c53c99ed00a831a28f1e8df07c553fcd59546465d13}{Side::Buy}}\ \&\&\ levelPrice\ >\ price)\ ||}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \ \ \ \ (side\ ==\ \mbox{\hyperlink{_side_8hpp_a8c0137d7160ad71b6ed265c53c99ed00a3068c5a98c003498f1fec0c489212e8b}{Side::Sell}}\ \&\&\ levelPrice\ <\ price))\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\string^\ filtering\ in\ out\ everything\ we\ dont\ need\ first}}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (quantity\ <=\ levelData.\_quantity)\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};\ \textcolor{comment}{//\ we're\ finding\ the\ acculate\ and\ seeing\ if\ we\ can\ find\ enough\ quantites\ }}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ quantity\ -\/=\ levelData.\_quantity;}
\DoxyCodeLine{00161\ \ \ \ \ \}}
\DoxyCodeLine{00162\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00163\ }
\DoxyCodeLine{00164\ \}}
\DoxyCodeLine{00165\ }
\DoxyCodeLine{00166\ \textcolor{comment}{//\ Private\ Event\ handlers\ (event\ APIs):\ revelent\ for\ fill\ or\ kill}}
\DoxyCodeLine{00167\ \textcolor{keywordtype}{void}\ Orderbook::onOrderCanceleld(\mbox{\hyperlink{_order_8hpp_abd4d2b4dd984ef7a42731f33c665be3e}{OrderPtr}}\ order)\ \{}
\DoxyCodeLine{00168\ \ \ \ \ UpdateLevelData(order-\/>getPrice(),\ order-\/>getRemainingQty(),\ LevelData::Action::Remove);}
\DoxyCodeLine{00169\ \}}
\DoxyCodeLine{00170\ \textcolor{keywordtype}{void}\ Orderbook::onOrderAdded(\mbox{\hyperlink{_order_8hpp_abd4d2b4dd984ef7a42731f33c665be3e}{OrderPtr}}\ order)\ \{}
\DoxyCodeLine{00171\ \ \ \ \ UpdateLevelData(order-\/>getPrice(),\ order-\/>getInitialQty(),\ LevelData::Action::Add);}
\DoxyCodeLine{00172\ \}}
\DoxyCodeLine{00173\ }
\DoxyCodeLine{00174\ \textcolor{keywordtype}{void}\ Orderbook::onOrderMatchedWithHistoryUpdate(\mbox{\hyperlink{_usings_8hpp_a375e30b119b87df2956b839a36a8d2d5}{Price}}\ price,\ \mbox{\hyperlink{_usings_8hpp_a90c79bb14ac40b274a4d20dd85f0469d}{Quantity}}\ quantity,\ \textcolor{keywordtype}{bool}\ isFullyFilled,\ \mbox{\hyperlink{_usings_8hpp_a375e30b119b87df2956b839a36a8d2d5}{Price}}\ purchasePrice)\ \{}
\DoxyCodeLine{00175\ }
\DoxyCodeLine{00176\ \ \ \ \ \textcolor{keywordflow}{if}\ (purchasePrice\ ==\ 0)\ \{\textcolor{comment}{/*DO\ NOTHING*/};\ \}}
\DoxyCodeLine{00177\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (isFullyFilled)\ \_orderDetailHistory.\mbox{\hyperlink{class_order_detail_history_a0209579741cc6ff09b61e37a4d2bda5e}{addOrderToPurchaseHistory}}(purchasePrice,\ quantity);}
\DoxyCodeLine{00178\ \ \ \ \ \textcolor{keywordflow}{else}\ \_orderDetailHistory.\mbox{\hyperlink{class_order_detail_history_a0209579741cc6ff09b61e37a4d2bda5e}{addOrderToPurchaseHistory}}(purchasePrice,\ std::min(quantity,\ \_data[price].\_quantity));}
\DoxyCodeLine{00179\ }
\DoxyCodeLine{00180\ \ \ \ \ \_orderDetailHistory.\mbox{\hyperlink{class_order_detail_history_addcc5e1737508a1974689610d20d4c27}{updateNeutralNetwork}}(purchasePrice,\ std::min(quantity,\ \_data[price].\_quantity));}
\DoxyCodeLine{00181\ }
\DoxyCodeLine{00182\ \ \ \ \ UpdateLevelData(price,\ quantity,\ isFullyFilled\ ?\ LevelData::Action::Remove\ :\ LevelData::Action::Match);}
\DoxyCodeLine{00183\ }
\DoxyCodeLine{00184\ \}}
\DoxyCodeLine{00185\ \textcolor{keywordtype}{void}\ Orderbook::onOrderMatched(\mbox{\hyperlink{_usings_8hpp_a375e30b119b87df2956b839a36a8d2d5}{Price}}\ price,\ \mbox{\hyperlink{_usings_8hpp_a90c79bb14ac40b274a4d20dd85f0469d}{Quantity}}\ quantity,\ \textcolor{keywordtype}{bool}\ isFullyFilled)\ \{}
\DoxyCodeLine{00186\ }
\DoxyCodeLine{00187\ \ \ \ \ UpdateLevelData(price,\ quantity,\ isFullyFilled\ ?\ LevelData::Action::Remove\ :\ LevelData::Action::Match);}
\DoxyCodeLine{00188\ }
\DoxyCodeLine{00189\ \}}
\DoxyCodeLine{00190\ }
\DoxyCodeLine{00191\ \textcolor{keywordtype}{void}\ Orderbook::UpdateLevelData(\mbox{\hyperlink{_usings_8hpp_a375e30b119b87df2956b839a36a8d2d5}{Price}}\ price,\ \mbox{\hyperlink{_usings_8hpp_a90c79bb14ac40b274a4d20dd85f0469d}{Quantity}}\ quantity,\ LevelData::Action\ action)\ \{}
\DoxyCodeLine{00192\ \ \ \ \ \textcolor{keyword}{auto}\&\ data\ =\ \_data[price];}
\DoxyCodeLine{00193\ }
\DoxyCodeLine{00194\ \ \ \ \ data.\_count\ +=\ action\ ==\ LevelData::Action::Remove\ ?\ -\/1\ :\ action\ ==\ LevelData::Action::Add\ ?\ 1\ :\ 0;}
\DoxyCodeLine{00195\ \ \ \ \ \textcolor{keywordflow}{if}\ (action\ ==\ LevelData::Action::Remove\ ||\ action\ ==\ LevelData::Action::Match)}
\DoxyCodeLine{00196\ \ \ \ \ \{}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ data.\_quantity\ -\/=\ quantity;}
\DoxyCodeLine{00198\ \ \ \ \ \}}
\DoxyCodeLine{00199\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00200\ \ \ \ \ \{}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ data.\_quantity\ +=\ quantity;}
\DoxyCodeLine{00202\ \ \ \ \ \}}
\DoxyCodeLine{00203\ }
\DoxyCodeLine{00204\ \ \ \ \ \textcolor{keywordflow}{if}\ (data.\_count\ ==\ 0)}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ \_data.erase(price);}
\DoxyCodeLine{00206\ \}}
\DoxyCodeLine{00207\ }
\DoxyCodeLine{00208\ \mbox{\hyperlink{_trade_8hpp_a2ac952e5c0e734c3b7ab2068eb3d6527}{Trades}}\ Orderbook::MatchOrder(\mbox{\hyperlink{class_order_modify}{OrderModify}}\ order)\ \{}
\DoxyCodeLine{00209\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_orders.contains(order.\mbox{\hyperlink{class_order_modify_a692c19566738eaf577ec4f667370959e}{getOrderId}}()))\ \textcolor{keywordflow}{return}\ \{\ \};}
\DoxyCodeLine{00210\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ [existingOrder,\ \_]\ =\ \_orders.at(order.\mbox{\hyperlink{class_order_modify_a692c19566738eaf577ec4f667370959e}{getOrderId}}());}
\DoxyCodeLine{00211\ \ \ \ \ \mbox{\hyperlink{class_orderbook_a3931170d2aebc21100ca99ee83823d96}{CancelOrder}}(order.\mbox{\hyperlink{class_order_modify_a692c19566738eaf577ec4f667370959e}{getOrderId}}());}
\DoxyCodeLine{00212\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespaceadd_order}{addOrder}}(order.\mbox{\hyperlink{class_order_modify_a5437e58124c8d3c858aa4501b673b456}{toOrderPtr}}(existingOrder-\/>getOrderType()));}
\DoxyCodeLine{00213\ \}}
\DoxyCodeLine{00214\ }
\DoxyCodeLine{00215\ }
\DoxyCodeLine{00216\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_orderbook_ae453ca6847a10f582b6ad4793fa6f9f8}{Orderbook::PruneGoodForDayOrders}}()\ \{}
\DoxyCodeLine{00217\ \ \ \ \ \textcolor{keyword}{using\ namespace\ }std::chrono;}
\DoxyCodeLine{00218\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ end\ =\ hours(16);}
\DoxyCodeLine{00219\ \ \ \ \ \textcolor{keywordflow}{while}\ (\textcolor{keyword}{true})\ \{}
\DoxyCodeLine{00220\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ now\ =\ system\_clock::now();}
\DoxyCodeLine{00221\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ now\_c\ =\ system\_clock::to\_time\_t(now);}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \ \ std::tm\ now\_parts;}
\DoxyCodeLine{00223\ \ \ \ \ \ \ \ \ localtime\_s(\&now\_parts,\ \&now\_c);}
\DoxyCodeLine{00224\ }
\DoxyCodeLine{00225\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (now\_parts.tm\_hour\ >=\ end.count())\ now\_parts.tm\_mday++;}
\DoxyCodeLine{00226\ }
\DoxyCodeLine{00227\ \ \ \ \ \ \ \ \ now\_parts.tm\_hour\ =\ end.count();}
\DoxyCodeLine{00228\ \ \ \ \ \ \ \ \ now\_parts.tm\_min\ =\ 0;}
\DoxyCodeLine{00229\ \ \ \ \ \ \ \ \ now\_parts.tm\_sec\ =\ 0;}
\DoxyCodeLine{00230\ }
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ next\ =\ system\_clock::from\_time\_t(mktime(\&now\_parts));}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ till\ =\ next\ -\/\ now\ +\ milliseconds(100);}
\DoxyCodeLine{00233\ }
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ \{\ \textcolor{comment}{//\ we\ dont\ want\ this\ thread\ to\ alter\ the\ state\ of\ out\ DS\ at\ the\ same\ time:\ Undefined\ behaviour}}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ \ \ \ \ std::unique\_lock\ ordersLock\{\ \_ordersMutex\ \};}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_shutdown.load(std::memory\_order\_acquire)\ \textcolor{comment}{//\ if\ orderbook\ is\ no\ longer\ in\ use\ run}}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ||\ \_shutdownConditionVariable.wait\_for(ordersLock,\ till)\ ==\ std::cv\_status::no\_timeout)\ \textcolor{comment}{//\ if\ signed\ a\ shutdown\ return}}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00240\ }
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_usings_8hpp_a486ef20e0a73d508bd0cce5f8217810b}{OrderIds}}\ orderIds;}
\DoxyCodeLine{00242\ }
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \ \ \ \ std::scoped\_lock\ ordersLock\{\ \_ordersMutex\ \};}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ [\_,\ entry]\ :\ \_orders)\ \{}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ [order,\ \_]\ =\ entry;}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (order-\/>getOrderType()\ !=\ \mbox{\hyperlink{_order_type_8hpp_a57124e387290311f33f3b54a54930418aba4a0e6c0bf4a4e1ac97580ed933f063}{OrderType::GoodForDay}})\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ orderIds.push\_back(order-\/>\mbox{\hyperlink{class_order_modify_a692c19566738eaf577ec4f667370959e}{getOrderId}}());}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00251\ }
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ CancelOrders(orderIds);}
\DoxyCodeLine{00253\ }
\DoxyCodeLine{00254\ \ \ \ \ \}}
\DoxyCodeLine{00255\ \}}
\DoxyCodeLine{00256\ }
\DoxyCodeLine{00257\ \mbox{\hyperlink{_trade_8hpp_a2ac952e5c0e734c3b7ab2068eb3d6527}{Trades}}\ \mbox{\hyperlink{class_orderbook_aa8ee3a736e8a72797565fdc645361c77}{Orderbook::addOrder}}(\mbox{\hyperlink{_order_type_8hpp_a57124e387290311f33f3b54a54930418}{OrderType}}\ type,\ \mbox{\hyperlink{_side_8hpp_a8c0137d7160ad71b6ed265c53c99ed00}{Side}}\ side,\ \mbox{\hyperlink{_usings_8hpp_a375e30b119b87df2956b839a36a8d2d5}{Price}}\ price,\ \mbox{\hyperlink{_usings_8hpp_a90c79bb14ac40b274a4d20dd85f0469d}{Quantity}}\ qty)\ \{}
\DoxyCodeLine{00258\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespaceadd_order}{addOrder}}(std::make\_shared<Order>(type,\ \mbox{\hyperlink{class_orderbook_af9aec9503cc33a10d6c5dee925a895fb}{Size}}()\ +\ 1,\ side,\ price,\ qty));}
\DoxyCodeLine{00259\ }
\DoxyCodeLine{00260\ \}}
\DoxyCodeLine{00261\ }
\DoxyCodeLine{00262\ \mbox{\hyperlink{_trade_8hpp_a2ac952e5c0e734c3b7ab2068eb3d6527}{Trades}}\ \mbox{\hyperlink{class_orderbook_aa8ee3a736e8a72797565fdc645361c77}{Orderbook::addOrder}}(\mbox{\hyperlink{_order_type_8hpp_a57124e387290311f33f3b54a54930418}{OrderType}}\ type,\ \mbox{\hyperlink{_usings_8hpp_a90716e500cb73455f03ac5b21fc7c219}{OrderId}}\ \textcolor{keywordtype}{id},\ \mbox{\hyperlink{_side_8hpp_a8c0137d7160ad71b6ed265c53c99ed00}{Side}}\ side,\ \mbox{\hyperlink{_usings_8hpp_a375e30b119b87df2956b839a36a8d2d5}{Price}}\ price,\ \mbox{\hyperlink{_usings_8hpp_a90c79bb14ac40b274a4d20dd85f0469d}{Quantity}}\ qty)\ \{}
\DoxyCodeLine{00263\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespaceadd_order}{addOrder}}(std::make\_shared<Order>(type,\ \textcolor{keywordtype}{id},\ side,\ price,\ qty));}
\DoxyCodeLine{00264\ }
\DoxyCodeLine{00265\ \}}
\DoxyCodeLine{00266\ }
\DoxyCodeLine{00267\ }
\DoxyCodeLine{00268\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_orderbook_a01b99124d091e1ceab16c44c15e67513}{Orderbook::addOrderViaPython}}(\textcolor{keywordtype}{int}\ type,\ \textcolor{keywordtype}{int}\ \textcolor{keywordtype}{id},\ \textcolor{keywordtype}{int}\ side,\ \textcolor{keywordtype}{int}\ price,\ \textcolor{keywordtype}{int}\ qty)\ \{}
\DoxyCodeLine{00269\ }
\DoxyCodeLine{00270\ \ \ \ \ \mbox{\hyperlink{namespaceadd_order}{addOrder}}(std::make\_shared<Order>(\mbox{\hyperlink{_order_type_8hpp_a45b54c9e8c1e53ef77a5d2c89fb4e4c7}{intToOrdertType}}(type),\ \textcolor{keywordtype}{id},\ side\ \%\ 2\ ==\ 1\ ?\ \mbox{\hyperlink{_side_8hpp_a8c0137d7160ad71b6ed265c53c99ed00a831a28f1e8df07c553fcd59546465d13}{Side::Buy}}\ :\ \mbox{\hyperlink{_side_8hpp_a8c0137d7160ad71b6ed265c53c99ed00a3068c5a98c003498f1fec0c489212e8b}{Side::Sell}}\ ,\ price,\ qty));}
\DoxyCodeLine{00271\ \ \ \ \ \mbox{\hyperlink{class_orderbook_a9702e3466bf51d56b6c05573271f9547}{saveToJson}}();}
\DoxyCodeLine{00272\ \}}
\DoxyCodeLine{00273\ }
\DoxyCodeLine{00274\ \mbox{\hyperlink{_trade_8hpp_a2ac952e5c0e734c3b7ab2068eb3d6527}{Trades}}\ \mbox{\hyperlink{class_orderbook_aa8ee3a736e8a72797565fdc645361c77}{Orderbook::addOrder}}(\mbox{\hyperlink{_order_8hpp_abd4d2b4dd984ef7a42731f33c665be3e}{OrderPtr}}\ order)\ \{}
\DoxyCodeLine{00275\ \ \ \ \ std::scoped\_lock\ ordersLock\{\ \_ordersMutex\ \};}
\DoxyCodeLine{00276\ }
\DoxyCodeLine{00277\ \ \ \ \ \textcolor{comment}{//\ add\ to\ history}}
\DoxyCodeLine{00278\ \ \ \ \ \_orderDetailHistory.\mbox{\hyperlink{class_order_detail_history_a65eb92a2eb981e3e765ee7e98c00f112}{addOrderToHistory}}(order-\/>getOrderType(),\ order-\/>getOrderId(),\ order-\/>getSide(),\ order-\/>getPrice(),\ order-\/>getQty());}
\DoxyCodeLine{00279\ }
\DoxyCodeLine{00280\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_orders.contains(order-\/>getOrderId()))\ \textcolor{keywordflow}{return}\ \{\ \};}
\DoxyCodeLine{00281\ }
\DoxyCodeLine{00282\ \ \ \ \ \textcolor{keywordflow}{if}\ (order-\/>getOrderType()\ ==\ \mbox{\hyperlink{_order_type_8hpp_a57124e387290311f33f3b54a54930418a31840a66a8d6d223e5b0540138768838}{OrderType::Market}})}
\DoxyCodeLine{00283\ \ \ \ \ \{}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (order-\/>getSide()\ ==\ \mbox{\hyperlink{_side_8hpp_a8c0137d7160ad71b6ed265c53c99ed00a831a28f1e8df07c553fcd59546465d13}{Side::Buy}}\ \&\&\ !\_asks.empty())}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00286\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ [worstAsk,\ \_]\ =\ *\_asks.rbegin();}
\DoxyCodeLine{00287\ \ \ \ \ \ \ \ \ \ \ \ \ order-\/>toGoodTillCancel(worstAsk);}
\DoxyCodeLine{00288\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (order-\/>getSide()\ ==\ \mbox{\hyperlink{_side_8hpp_a8c0137d7160ad71b6ed265c53c99ed00a3068c5a98c003498f1fec0c489212e8b}{Side::Sell}}\ \&\&\ !\_bids.empty())}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00291\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ [worstBid,\ \_]\ =\ *\_bids.rbegin();}
\DoxyCodeLine{00292\ \ \ \ \ \ \ \ \ \ \ \ \ order-\/>toGoodTillCancel(worstBid);}
\DoxyCodeLine{00293\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00294\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00295\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \{\ \};}
\DoxyCodeLine{00296\ \ \ \ \ \}}
\DoxyCodeLine{00297\ }
\DoxyCodeLine{00298\ }
\DoxyCodeLine{00299\ \ \ \ \ \textcolor{keywordflow}{if}\ (order-\/>getOrderType()\ ==\ \mbox{\hyperlink{_order_type_8hpp_a57124e387290311f33f3b54a54930418aecbd0e0c1a29b254d42a648d45b65fb9}{OrderType::FillAndKill}}\ \&\&\ !canMatch(order-\/>getSide(),\ order-\/>getPrice()))\ \textcolor{keywordflow}{return}\ \{\ \};}
\DoxyCodeLine{00300\ \ \ \ \ \textcolor{keywordflow}{if}\ (order-\/>getOrderType()\ ==\ \mbox{\hyperlink{_order_type_8hpp_a57124e387290311f33f3b54a54930418aaca8c369e3b611e1109cc77a7feaf872}{OrderType::FillOrKill}}\ \&\&\ !canFullyFill(order-\/>getSide(),\ order-\/>getPrice(),\ order-\/>getInitialQty()))\ \textcolor{keywordflow}{return}\ \{\ \};\ \textcolor{comment}{//\ if\ it\ can\ not\ fill\ all\ then\ ignore\ order}}
\DoxyCodeLine{00301\ }
\DoxyCodeLine{00302\ \ \ \ \ OrderPtrs::iterator\ iter;}
\DoxyCodeLine{00303\ \ \ \ \ \textcolor{keywordflow}{if}\ (order-\/>getSide()\ ==\ \mbox{\hyperlink{_side_8hpp_a8c0137d7160ad71b6ed265c53c99ed00a831a28f1e8df07c553fcd59546465d13}{Side::Buy}})\ \{}
\DoxyCodeLine{00304\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\&\ orders\ =\ \_bids[order-\/>getPrice()];}
\DoxyCodeLine{00305\ \ \ \ \ \ \ \ \ orders.push\_back(order);}
\DoxyCodeLine{00306\ \ \ \ \ \ \ \ \ iter\ =\ std::next(orders.begin(),\ orders.size()\ -\/\ 1);}
\DoxyCodeLine{00307\ \ \ \ \ \}}
\DoxyCodeLine{00308\ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00309\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\&\ orders\ =\ \_asks[order-\/>getPrice()];}
\DoxyCodeLine{00310\ \ \ \ \ \ \ \ \ orders.push\_back(order);}
\DoxyCodeLine{00311\ \ \ \ \ \ \ \ \ iter\ =\ std::next(orders.begin(),\ orders.size()\ -\/\ 1);}
\DoxyCodeLine{00312\ \ \ \ \ \}}
\DoxyCodeLine{00313\ \ \ \ \ \_orders.insert(\{\ order-\/>getOrderId(),OrderEntry\{order,iter\}\ \});}
\DoxyCodeLine{00314\ \ \ \ \ \textcolor{comment}{//TODO:Check\ to\ see\ where\ it\ goes\ to\ size\ >\ 9\ in\ both}}
\DoxyCodeLine{00315\ \ \ \ \ \textcolor{comment}{//if\ (\_orders.size()\ >\ 9)\ throw\ std::logic\_error("{}here"{});}}
\DoxyCodeLine{00316\ \ \ \ \ onOrderAdded(order);}
\DoxyCodeLine{00317\ }
\DoxyCodeLine{00318\ \ \ \ \ \textcolor{keywordflow}{return}\ MatchOrders();}
\DoxyCodeLine{00319\ \}}
\DoxyCodeLine{00320\ }
\DoxyCodeLine{00321\ }
\DoxyCodeLine{00322\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_orderbook_a3931170d2aebc21100ca99ee83823d96}{Orderbook::CancelOrder}}(\mbox{\hyperlink{_usings_8hpp_a90716e500cb73455f03ac5b21fc7c219}{OrderId}}\ orderId)\ \{}
\DoxyCodeLine{00323\ \ \ \ \ std::scoped\_lock\ ordersLock\{\ \_ordersMutex\ \};}
\DoxyCodeLine{00324\ \ \ \ \ CancelOrderInternal(orderId);}
\DoxyCodeLine{00325\ }
\DoxyCodeLine{00326\ \}}
\DoxyCodeLine{00327\ }
\DoxyCodeLine{00328\ \mbox{\hyperlink{_trade_8hpp_a2ac952e5c0e734c3b7ab2068eb3d6527}{Trades}}\ \mbox{\hyperlink{class_orderbook_a1acc77c9ffaddc1ca56f02df0a556426}{Orderbook::ModifyOrder}}(\mbox{\hyperlink{class_order_modify}{OrderModify}}\ order)\ \{}
\DoxyCodeLine{00329\ \ \ \ \ \mbox{\hyperlink{_order_type_8hpp_a57124e387290311f33f3b54a54930418}{OrderType}}\ orderType;}
\DoxyCodeLine{00330\ \ \ \ \ \{}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \ \ std::scoped\_lock\ ordersLock\{\ \_ordersMutex\ \};}
\DoxyCodeLine{00332\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_orders.contains(order.\mbox{\hyperlink{class_order_modify_a692c19566738eaf577ec4f667370959e}{getOrderId}}()))\ \textcolor{keywordflow}{return}\ \{\ \};}
\DoxyCodeLine{00333\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ [existingOrder,\ \_]\ =\ \_orders.at(order.\mbox{\hyperlink{class_order_modify_a692c19566738eaf577ec4f667370959e}{getOrderId}}());}
\DoxyCodeLine{00334\ \ \ \ \ \ \ \ \ orderType\ =\ existingOrder-\/>getOrderType();}
\DoxyCodeLine{00335\ \ \ \ \ \}}
\DoxyCodeLine{00336\ \ \ \ \ \mbox{\hyperlink{class_orderbook_a3931170d2aebc21100ca99ee83823d96}{CancelOrder}}(order.\mbox{\hyperlink{class_order_modify_a692c19566738eaf577ec4f667370959e}{getOrderId}}());}
\DoxyCodeLine{00337\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespaceadd_order}{addOrder}}(order.\mbox{\hyperlink{class_order_modify_a5437e58124c8d3c858aa4501b673b456}{toOrderPtr}}(orderType));}
\DoxyCodeLine{00338\ \}}
\DoxyCodeLine{00339\ }
\DoxyCodeLine{00340\ }
\DoxyCodeLine{00341\ std::size\_t\ \mbox{\hyperlink{class_orderbook_af9aec9503cc33a10d6c5dee925a895fb}{Orderbook::Size}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \_orders.size();\ \}}
\DoxyCodeLine{00342\ }
\DoxyCodeLine{00343\ \textcolor{comment}{//\ Orderbook\ levels\ info\ object\ to\ represnet\ the\ aggreatate\ internal\ state\ of\ order\ book:\ useful\ for\ testing\ or\ market\ data\ decimination}}
\DoxyCodeLine{00344\ \mbox{\hyperlink{class_orderbook_level_infos}{OrderbookLevelInfos}}\ \mbox{\hyperlink{class_orderbook_a952bf9295a260ff01d0f787713ca65af}{Orderbook::getOrderInfos}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00345\ \ \ \ \ \mbox{\hyperlink{_level_info_8hpp_acc6a50eef88f06795f4029aec7837905}{LevelInfos}}\ bidInfos,\ askInfos;}
\DoxyCodeLine{00346\ \ \ \ \ bidInfos.reserve(\_orders.size());}
\DoxyCodeLine{00347\ \ \ \ \ askInfos.reserve(\_orders.size());}
\DoxyCodeLine{00348\ }
\DoxyCodeLine{00349\ \ \ \ \ \textcolor{keyword}{auto}\ CreateLevelInfos\ =\ [](\mbox{\hyperlink{_usings_8hpp_a375e30b119b87df2956b839a36a8d2d5}{Price}}\ price,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{_order_8hpp_aa7f24058c403f699fbc193d03b0b854a}{OrderPtrs}}\&\ orders)}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00351\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{struct_level_info}{LevelInfo}}\{\ price,\ std::accumulate(orders.begin(),\ orders.end(),\ (\mbox{\hyperlink{_usings_8hpp_a90c79bb14ac40b274a4d20dd85f0469d}{Quantity}})0,}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](\mbox{\hyperlink{_usings_8hpp_a90c79bb14ac40b274a4d20dd85f0469d}{Quantity}}\ runningSum,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{_order_8hpp_abd4d2b4dd984ef7a42731f33c665be3e}{OrderPtr}}\&\ order)}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{\ return\ runningSum\ +\ order-\/>getRemainingQty();\ \})\ \};}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{00355\ }
\DoxyCodeLine{00356\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ [price,\ orders]\ :\ \_bids)}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \ \ bidInfos.push\_back(CreateLevelInfos(price,\ orders));}
\DoxyCodeLine{00358\ }
\DoxyCodeLine{00359\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ [price,\ orders]\ :\ \_asks)}
\DoxyCodeLine{00360\ \ \ \ \ \ \ \ \ askInfos.push\_back(CreateLevelInfos(price,\ orders));}
\DoxyCodeLine{00361\ }
\DoxyCodeLine{00362\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_orderbook_level_infos}{OrderbookLevelInfos}}\{\ bidInfos,\ askInfos\ \};}
\DoxyCodeLine{00363\ }
\DoxyCodeLine{00364\ \}}
\DoxyCodeLine{00365\ }
\DoxyCodeLine{00366\ }
\DoxyCodeLine{00367\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_orderbook_aee40f7d214986ff6b0779fe12c498594}{Orderbook::printAllOrders}}()\ \{}
\DoxyCodeLine{00368\ \ \ \ \ \textcolor{comment}{//\_orderDetailHistory.\_printSellHistory();}}
\DoxyCodeLine{00369\ \ \ \ \ \textcolor{comment}{//\_orderDetailHistory.\_printBuyHistory();}}
\DoxyCodeLine{00370\ \ \ \ \ \_orderDetailHistory.\mbox{\hyperlink{class_order_detail_history_ae1699409e402747d0249b4cacb69e08b}{\_printPurchaseHistory}}();}
\DoxyCodeLine{00371\ \ \ \ \ \textcolor{comment}{//\_orderDetailHistory.\_printLiveOrders();}}
\DoxyCodeLine{00372\ }
\DoxyCodeLine{00373\ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Purchase\ History\ Size:\ "{}}\ <<\ \_orderDetailHistory.\mbox{\hyperlink{class_order_detail_history_add68962f12a00beadf15c2d3f19f2838}{purchaseHistorySize}}();}
\DoxyCodeLine{00374\ }
\DoxyCodeLine{00375\ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Sell\ History\ Size:\ "{}}\ <<\ \_orderDetailHistory.\mbox{\hyperlink{class_order_detail_history_a6bed3ea20f7b2f16e453fcb5dfed9fd1}{sellHistorySize}}();}
\DoxyCodeLine{00376\ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Buy\ History\ Size:\ "{}}\ <<\ \_orderDetailHistory.\mbox{\hyperlink{class_order_detail_history_a8c6d46b597381a834d361ee510839c93}{buyHistorySize}}();}
\DoxyCodeLine{00377\ \ \ \ \ }
\DoxyCodeLine{00378\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_orderDetailHistory.\mbox{\hyperlink{class_order_detail_history_ace0afa64e4e248705363c6e35fc9dbbc}{getVWAP}}()\ ==\ 0)\ std::cout\ <<\ \textcolor{stringliteral}{"{}No\ purchases\ made"{}}\ <<\ std::endl;}
\DoxyCodeLine{00379\ \ \ \ \ \textcolor{keywordflow}{else}\ std::cout\ <<\ \textcolor{stringliteral}{"{}The\ VWAP\ of\ this\ item\ is\ "{}}\ <<\ \_orderDetailHistory.\mbox{\hyperlink{class_order_detail_history_ace0afa64e4e248705363c6e35fc9dbbc}{getVWAP}}()\ <<\ std::endl;}
\DoxyCodeLine{00380\ }
\DoxyCodeLine{00381\ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}PREDICTION\ "{}}\ <<\ \_orderDetailHistory.\mbox{\hyperlink{class_order_detail_history_a7901c7d902a3e0412328432978781da0}{getPrediction}}()\ <<\ std::endl;}
\DoxyCodeLine{00382\ \ \ \ \ }
\DoxyCodeLine{00383\ \}}
\DoxyCodeLine{00384\ }
\DoxyCodeLine{00385\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_orderbook_a9702e3466bf51d56b6c05573271f9547}{Orderbook::saveToJson}}(\textcolor{keyword}{const}\ std::string\&\ buyfilename,\ \textcolor{keyword}{const}\ std::string\&\ sellfilename,\ \textcolor{keyword}{const}\ std::string\&\ purchasefilename,\ \textcolor{keyword}{const}\ std::string\&\ buyLivefilename,\ \textcolor{keyword}{const}\ std::string\&\ sellLivefilename)\ \{}
\DoxyCodeLine{00386\ \ \ \ \ \_orderDetailHistory.saveHistoryToJson(buyfilename,\ sellfilename,\ purchasefilename,\ sellLivefilename,\ buyLivefilename);}
\DoxyCodeLine{00387\ \}}
\DoxyCodeLine{00388\ }
\DoxyCodeLine{00389\ }
\DoxyCodeLine{00390\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_orderbook_aad91e372cc4e6454c03e4b4a43dad977}{Orderbook::changeExecutionType}}(\textcolor{keywordtype}{int}\ type)\ \{}
\DoxyCodeLine{00391\ \ \ \ \ \textcolor{keywordflow}{switch}\ (type)\ \{}
\DoxyCodeLine{00392\ \ \ \ \ \textcolor{keywordflow}{case}\ 0:\ \_executionType\ =\ ExecutionTypes::BuyersPrice;\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00393\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ \_executionType\ =\ ExecutionTypes::SellersPrice;\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00394\ \ \ \ \ \textcolor{keywordflow}{case}\ 2:\ \_executionType\ =\ ExecutionTypes::MidPrice;\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00395\ \ \ \ \ \textcolor{keywordflow}{default}:\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00396\ \ \ \ \ \}}
\DoxyCodeLine{00397\ \}}
\DoxyCodeLine{00398\ }
\DoxyCodeLine{00399\ }
\DoxyCodeLine{00400\ }
\DoxyCodeLine{00401\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_orderbook_aa141f3177a4abd843e53fffbf6699f19}{Orderbook::EndOfDay}}()\ \{}
\DoxyCodeLine{00402\ \ \ \ \ std::unordered\_map<OrderId,\ bool>\ goodToCancels;}
\DoxyCodeLine{00403\ }
\DoxyCodeLine{00404\ \ \ \ \ \textcolor{comment}{//\ Handle\ live\ orders}}
\DoxyCodeLine{00405\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ m\ :\ \_orderDetailHistory.\mbox{\hyperlink{class_order_detail_history_a2125b507c1f6844d995b2ce67b63f340}{getLiveOrders}}())\ \{}
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m.second.OrderType()\ !=\ \mbox{\hyperlink{_order_type_8hpp_a57124e387290311f33f3b54a54930418aba4a0e6c0bf4a4e1ac97580ed933f063}{OrderType::GoodForDay}})\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00407\ \ \ \ \ \ \ \ \ goodToCancels[m.first]\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00408\ \ \ \ \ \ \ \ \ \_orderDetailHistory.\mbox{\hyperlink{class_order_detail_history_a850bb8c0917adec18a552e7a093b0be2}{deleteALiveOrder}}(m.first);}
\DoxyCodeLine{00409\ \ \ \ \ \}}
\DoxyCodeLine{00410\ }
\DoxyCodeLine{00411\ \ \ \ \ \textcolor{comment}{//\ Remove\ orders\ not\ in\ goodToCancels}}
\DoxyCodeLine{00412\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ it\ =\ \_orders.begin();\ it\ !=\ \_orders.end();\ )\ \{}
\DoxyCodeLine{00413\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (goodToCancels.find(it-\/>first)\ !=\ goodToCancels.end())\ \{}
\DoxyCodeLine{00414\ \ \ \ \ \ \ \ \ \ \ \ \ ++it;}
\DoxyCodeLine{00415\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00416\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00417\ \ \ \ \ \ \ \ \ \ \ \ \ it\ =\ \_orders.erase(it);}
\DoxyCodeLine{00418\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00419\ \ \ \ \ \}}
\DoxyCodeLine{00420\ }
\DoxyCodeLine{00421\ \ \ \ \ \textcolor{comment}{//\ Clean\ up\ bids}}
\DoxyCodeLine{00422\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ it\ =\ \_bids.begin();\ it\ !=\ \_bids.end();\ )\ \{}
\DoxyCodeLine{00423\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\&\ orderptrs\ =\ it-\/>second;}
\DoxyCodeLine{00424\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ orderIt\ =\ orderptrs.begin();\ orderIt\ !=\ orderptrs.end();\ )\ \{}
\DoxyCodeLine{00425\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (goodToCancels.find((*orderIt)-\/>getOrderId())\ !=\ goodToCancels.end())\ \{}
\DoxyCodeLine{00426\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ orderIt\ =\ orderptrs.erase(orderIt);}
\DoxyCodeLine{00427\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00429\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ++orderIt;}
\DoxyCodeLine{00430\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00431\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00432\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (orderptrs.empty())\ \{}
\DoxyCodeLine{00433\ \ \ \ \ \ \ \ \ \ \ \ \ it\ =\ \_bids.erase(it);}
\DoxyCodeLine{00434\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00435\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00436\ \ \ \ \ \ \ \ \ \ \ \ \ ++it;}
\DoxyCodeLine{00437\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00438\ \ \ \ \ \}}
\DoxyCodeLine{00439\ }
\DoxyCodeLine{00440\ \ \ \ \ \textcolor{comment}{//\ Clean\ up\ asks}}
\DoxyCodeLine{00441\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ it\ =\ \_asks.begin();\ it\ !=\ \_asks.end();\ )\ \{}
\DoxyCodeLine{00442\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\&\ orderptrs\ =\ it-\/>second;}
\DoxyCodeLine{00443\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ orderIt\ =\ orderptrs.begin();\ orderIt\ !=\ orderptrs.end();\ )\ \{}
\DoxyCodeLine{00444\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (goodToCancels.find((*orderIt)-\/>getOrderId())\ !=\ goodToCancels.end())\ \{}
\DoxyCodeLine{00445\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ orderIt\ =\ orderptrs.erase(orderIt);}
\DoxyCodeLine{00446\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00447\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00448\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ++orderIt;}
\DoxyCodeLine{00449\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00450\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00451\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (orderptrs.empty())\ \{}
\DoxyCodeLine{00452\ \ \ \ \ \ \ \ \ \ \ \ \ it\ =\ \_asks.erase(it);}
\DoxyCodeLine{00453\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00454\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00455\ \ \ \ \ \ \ \ \ \ \ \ \ ++it;}
\DoxyCodeLine{00456\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00457\ \ \ \ \ \}}
\DoxyCodeLine{00458\ \}}
\DoxyCodeLine{00459\ }
\DoxyCodeLine{00460\ }
\DoxyCodeLine{00461\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_orderbook_a9c3382623ecc8a532b3a5342e95a75f6}{Orderbook::setPriceScale}}(\mbox{\hyperlink{_usings_8hpp_a375e30b119b87df2956b839a36a8d2d5}{Price}}\ \_price)\ \{}
\DoxyCodeLine{00462\ \ \ \ \ \_orderDetailHistory.\mbox{\hyperlink{class_order_detail_history_a0f61c9092fdc0a7ec354695cb122f0ff}{PRICESCALE}}\ =\ \_price;}
\DoxyCodeLine{00463\ \}}
\DoxyCodeLine{00464\ }
\DoxyCodeLine{00465\ \mbox{\hyperlink{_usings_8hpp_a375e30b119b87df2956b839a36a8d2d5}{Price}}\ \mbox{\hyperlink{class_orderbook_acb02b65f6d820f076c0da649cd860acc}{Orderbook::getPriceScale}}()\ \{}
\DoxyCodeLine{00466\ \ \ \ \ \textcolor{keywordflow}{return}\ \_orderDetailHistory.\mbox{\hyperlink{class_order_detail_history_a0f61c9092fdc0a7ec354695cb122f0ff}{PRICESCALE}};}
\DoxyCodeLine{00467\ \}}

\end{DoxyCode}
